"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),y=require("./popconfirm.js"),q=require("../../trigger/index.js"),E=require("../../icon/index.js"),k=require("../../button/index.js"),g=require("@tu-view-plus/hooks"),a=require("@tu-view-plus/utils");require("../style/popconfirm.css");const D=e.defineComponent({name:"TuPopconfirm"}),L=e.defineComponent({...D,props:y.popconfirmProps,emits:y.popconfirmEmits,setup(v,{emit:V}){let i=0;const t=v,r=V,{t:m}=g.useLocale(),n=g.useNamespace("popconfirm"),c=e.ref(t.defaultPopupVisible),l=e.ref(!1),w=e.computed(()=>t.popupVisible??c.value),B=e.computed(()=>t.okLoading||l.value),f=e.computed(()=>a.TypeComponentsMap[t.type]||""),h=e.computed(()=>{const o=t.type;return{[n.em("icon",o)]:o&&a.TypeComponentsMap[o]}}),b=e.computed(()=>({[n.b()]:!0,[n.m(t.size)]:t.size})),P=e.computed(()=>[n.e("popup-content"),t.contentClass]),T=e.computed(()=>[n.e("popup-arrow"),t.arrowClass]),p=()=>{i++,l.value&&(l.value=!1),c.value=!1,r("update:popupVisible",!1),r("popupVisibleChange",!1)},N=o=>{o?(c.value=o,r("update:popupVisible",o),r("popupVisibleChange",o)):p()},z=()=>{let o=!0;a.isFunction(t.onBeforeCancel)&&(o=t.onBeforeCancel()??!1),o&&(r("cancel"),p())},S=async()=>{const o=i,d=await new Promise(async u=>{if(a.isFunction(t.onBeforeOk)){let s=t.onBeforeOk((C=!0)=>u(C));if((a.isPromise(s)||!a.isBoolean(s))&&(l.value=!0),a.isPromise(s))try{s=await s??!0}catch{s=!1}a.isBoolean(s)&&u(s)}else u(!0)});o===i&&(d?(r("ok"),p()):l.value&&(l.value=!1))};return(o,d)=>(e.openBlock(),e.createBlock(e.unref(q.TuTrigger),{"show-arrow":"",trigger:"click","animation-name":"zoom-in-fade-out","auto-fit-transform-origin":"",class:e.normalizeClass(b.value),position:o.position,"popup-visible":w.value,"popup-offset":14,"popup-container":o.popupContainer,"content-class":P.value,"content-style":o.contentStyle,"arrow-class":T.value,"arrow-style":o.arrowStyle,onPopupVisibleChange:N},{content:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(e.unref(n).e("body"))},[o.type?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass([e.unref(n).e("icon"),h.value])},[f.value?(e.openBlock(),e.createBlock(e.unref(E.TuIcon),{key:0},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(f.value)))]),_:1})):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0),e.createElementVNode("span",{class:e.normalizeClass(e.unref(n).e("content"))},[e.renderSlot(o.$slots,"content",{},()=>[e.createTextVNode(e.toDisplayString(o.content),1)])],2)],2),e.createElementVNode("div",{class:e.normalizeClass(e.unref(n).e("footer"))},[e.createVNode(e.unref(k.TuButton),e.mergeProps({size:"small"},o.cancelButtonProps,{onClick:z}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.cancelText||e.unref(m)("tu.modal.cancel")),1)]),_:1},16),e.createVNode(e.unref(k.TuButton),e.mergeProps({size:"small",type:"primary"},o.okButtonProps,{loading:B.value,onClick:S}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.okText||e.unref(m)("tu.modal.confirm")),1)]),_:1},16,["loading"])],2)]),default:e.withCtx(()=>[e.renderSlot(o.$slots,"default")]),_:3},8,["class","position","popup-visible","popup-container","content-class","content-style","arrow-class","arrow-style"]))}});exports.default=L;
