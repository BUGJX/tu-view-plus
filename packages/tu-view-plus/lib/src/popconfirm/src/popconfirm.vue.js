"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),y=require("./popconfirm.js"),z=require("../../trigger/index.js"),S=require("../../icon/index.js"),k=require("@tu-view-plus/hooks"),r=require("@tu-view-plus/utils");require("../style/popconfirm.css");const q=e.defineComponent({name:"TuPopconfirm"}),E=e.defineComponent({...q,props:y.popconfirmProps,emits:y.popconfirmEmits,setup(g,{emit:a}){const n=g;let c=0;const{t:f}=k.useLocale(),t=k.useNamespace("popconfirm"),p=e.ref(n.defaultPopupVisible),i=e.ref(!1),V=e.computed(()=>n.popupVisible??p.value),w=e.computed(()=>n.okLoading||i.value),m=e.computed(()=>r.TypeComponentsMap[n.type]||""),b=e.computed(()=>{const o=n.type;return{[t.em("icon",o)]:o&&r.TypeComponentsMap[o]}}),h=e.computed(()=>({[t.b()]:!0,[t.m(n.size)]:n.size})),B=e.computed(()=>[t.e("popup-content"),n.contentClass]),P=e.computed(()=>[t.e("popup-arrow"),n.arrowClass]),u=()=>{c++,i.value&&(i.value=!1),p.value=!1,a("update:popupVisible",!1),a("popupVisibleChange",!1)},v=o=>{o?(p.value=o,a("update:popupVisible",o),a("popupVisibleChange",o)):u()},N=()=>{let o=!0;r.isFunction(n.onBeforeCancel)&&(o=n.onBeforeCancel()??!1),o&&(a("cancel"),u())},T=async()=>{const o=c,d=await new Promise(async l=>{if(r.isFunction(n.onBeforeOk)){let s=n.onBeforeOk((C=!0)=>l(C));if((r.isPromise(s)||!r.isBoolean(s))&&(i.value=!0),r.isPromise(s))try{s=await s??!0}catch{s=!1}r.isBoolean(s)&&l(s)}else l(!0)});o===c&&(d?(a("ok"),u()):i.value&&(i.value=!1))};return(o,d)=>{const l=e.resolveComponent("tu-button");return e.openBlock(),e.createBlock(e.unref(z.TuTrigger),{"show-arrow":"",trigger:"click","animation-name":"zoom-in-fade-out","auto-fit-transform-origin":"",class:e.normalizeClass(e.unref(h)),position:o.position,"popup-visible":e.unref(V),"popup-offset":14,"popup-container":o.popupContainer,"content-class":e.unref(B),"content-style":o.contentStyle,"arrow-class":e.unref(P),"arrow-style":o.arrowStyle,onPopupVisibleChange:v},{content:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(e.unref(t).e("body"))},[o.type?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass([e.unref(t).e("icon"),e.unref(b)])},[e.unref(m)?(e.openBlock(),e.createBlock(e.unref(S.TuIcon),{key:0},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(m))))]),_:1})):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0),e.createElementVNode("span",{class:e.normalizeClass(e.unref(t).e("content"))},[e.renderSlot(o.$slots,"content",{},()=>[e.createTextVNode(e.toDisplayString(o.content),1)])],2)],2),e.createElementVNode("div",{class:e.normalizeClass(e.unref(t).e("footer"))},[e.createVNode(l,e.mergeProps({size:"mini"},o.cancelButtonProps,{onClick:N}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.cancelText||e.unref(f)("tu.modal.cancel")),1)]),_:1},16),e.createVNode(l,e.mergeProps({size:"mini",type:"primary"},o.okButtonProps,{loading:e.unref(w),onClick:T}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.okText||e.unref(f)("tu.modal.confirm")),1)]),_:1},16,["loading"])],2)]),default:e.withCtx(()=>[e.renderSlot(o.$slots,"default")]),_:3},8,["class","position","popup-visible","popup-container","content-class","content-style","arrow-class","arrow-style"])}}});exports.default=E;
