"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),L=require("@tu-view-plus/hooks"),d=require("@tu-view-plus/utils"),q=require("./slider.js");require("../../form/index.js");const k=require("number-precision"),B=require("./utils.js"),O=require("./slider-ticks.vue.js"),S=require("./slider-button.vue.js");require("../style/slider.css");const j=require("../../form/src/hooks/use-form-props.js"),U=e.defineComponent({name:"TuSlider"}),X=e.defineComponent({...U,props:q.sliderProps,emits:q.sliderEmits,setup(z,{emit:c}){const t=z;k.enableBoundaryChecking(!1);const l=L.useNamespace("slider"),m=j.useFormDisabled(),a=e.ref(null),f=e.ref(),i=t.modelValue?t.modelValue:t.defaultValue,s=e.ref(d.isArray(i)?i[0]:0),n=e.ref(d.isArray(i)?i[1]:i),y=e.ref(!1),w=e.computed(()=>({[l.b()]:!0,[l.m("vertical")]:t.direction==="vertical",[l.m(t.size)]:t.size,[l.is("with-marks")]:!!t.marks})),T=e.computed(()=>({[l.e("track")]:!0,[l.m("vertical")]:t.direction==="vertical",[l.is("disabled")]:m.value})),v=e.computed(()=>t.range?d.isArray(t.modelValue)?t.modelValue:[s.value,t.modelValue??n.value]:d.isUndefined(t.modelValue)?[s.value,n.value]:d.isArray(t.modelValue)?[t.min??0,t.modelValue[1]]:[t.min??0,t.modelValue]),p=(o,r)=>{if(!f.value)return 0;const{left:h,top:R,width:A,height:b}=f.value,V=t.direction==="horizontal"?A:b,D=V*t.step/(t.max-t.min);let u=t.direction==="horizontal"?o-h:R+b-r;u<0&&(u=0),u>V&&(u=V);const F=Math.round(u/D);return k.plus(t.min,k.times(F,t.step))},C=o=>B.getPositionStyle(B.getOffsetPercent(o,[t.min,t.max]),t.direction),g=()=>{t.range?(c("update:modelValue",[s.value,n.value]),c("change",[s.value,n.value])):(c("update:modelValue",n.value),c("change",n.value))},N=o=>{if(m.value)return;const{clientX:r,clientY:h}=o;a.value&&(f.value=a.value.getBoundingClientRect()),n.value=p(r,h),g()},_=()=>{y.value=!0,a.value&&(f.value=a.value.getBoundingClientRect())},E=(o,r)=>{s.value=p(o,r),g()},M=()=>{y.value=!1},P=(o,r)=>{n.value=p(o,r),g()};return(o,r)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(w))},[e.createElementVNode("div",{ref_key:"trackRef",ref:a,class:e.normalizeClass(e.unref(T)),onClick:N},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(l).e("bar"))},null,2),e.createVNode(O.default),o.range?(e.openBlock(),e.createBlock(S.default,{key:0,style:e.normalizeStyle(C(e.unref(v)[0])),min:o.min,max:o.max,disabled:e.unref(m),direction:o.direction,value:e.unref(v)[0],"format-tooltip":o.formatTooltip,"show-tooltip":o.showTooltip,onMovestart:_,onMoving:E,onMoveend:M},null,8,["style","min","max","disabled","direction","value","format-tooltip","show-tooltip"])):e.createCommentVNode("",!0),e.createVNode(S.default,{style:e.normalizeStyle(C(e.unref(v)[1])),min:o.min,max:o.max,direction:o.direction,disabled:e.unref(m),value:e.unref(v)[1],"format-tooltip":o.formatTooltip,"show-tooltip":o.showTooltip,onMovestart:_,onMoving:P,onMoveend:M},null,8,["style","min","max","direction","disabled","value","format-tooltip","show-tooltip"])],2)],2))}});exports.default=X;
