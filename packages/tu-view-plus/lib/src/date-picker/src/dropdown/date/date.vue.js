"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),D=require("./date.js"),E=require("@tu-view-plus/hooks"),v=require("@tu-view-plus/utils"),P=require("@tu-view-plus/icons-vue");require("b-tween");const Q=require("../../hooks/use-merge-state.js"),q=require("../../utils.js"),X=require("../header.vue.js"),Z=require("../week-list.vue.js"),x=require("../body.vue.js"),ee=require("../../../../time-picker/src/time-picker-dropdown.vue.js"),L=require("../../../../icon/index.js"),te=e.defineComponent({name:"TuDate"}),ae=e.defineComponent({...te,props:D.dateProps,emits:D.dateEmits,setup($,{emit:M}){const S=t=>({label:t.date(),value:t}),z=$,n=M,s=E.useNamespace("picker"),{t:U}=E.useLocale(),{isRange:m,headerValue:p,footerValue:o,dayStartOfWeek:B,isSameTime:f,mode:u,showTime:c,currentView:Y,disabledTime:i}=e.toRefs(z),[V,I]=Q.useMergeState("date",e.reactive({value:Y})),C=e.computed(()=>(u==null?void 0:u.value)==="week"),a=e.computed(()=>C.value?"dropdown-week":"dropdown-date"),d=e.computed(()=>c.value&&m.value),g=e.computed(()=>!c.value||!d.value||V.value==="date"),R=e.computed(()=>p.value.format("YYYY-MM")),k=e.computed(()=>{const t=[0,1,2,3,4,5,6],l=Math.max(B.value%7,0);return[...t.slice(l),...t.slice(0,l)]}),W=e.computed(()=>C.value?[-1,...k.value]:k.value),H=e.computed(()=>{const t=v.methods.startOf(p.value,"month"),l=t.day(),y=t.daysInMonth(),w=k.value.indexOf(l),_=q.newArray(42);for(let r=0;r<_.length;r++)_[r]={...S(v.methods.add(t,r-w,"day")),isPrev:r<w,isNext:r>w+y-1};return q.newArray(6).map((r,b)=>{const N=_.slice(b*7,(b+1)*7);if(C.value){const T=N[0].value;N.unshift({label:T.week(),value:T})}return N})}),A=e.computed(()=>(f==null?void 0:f.value)||((t,l)=>t.isSame(l,"day"))),O=e.computed(()=>c.value&&(!d.value||V.value==="time")),j=e.computed(()=>{var t;return c.value&&((t=i==null?void 0:i.value)==null?void 0:t.call(i,v.getDateValue((o==null?void 0:o.value)||v.getNow())))||{}}),F=e.computed(()=>({[s.e(a.value)]:!0,[s.em(a.value,"with-view-tabs")]:d.value})),G=t=>{n("select",t.value)},J=t=>{n("cell-mouse-enter",t.value)},K=t=>{n("time-picker-select",t)},h=t=>{n("current-view-change",t),n("update:currentView",t),I(t)};return(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(F.value)},[g.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(s).e(`${a.value}-inner`))},[e.createVNode(X.default,e.mergeProps({...t.headerOperations,icons:t.headerIcons},{title:R.value,mode:e.unref(u),value:e.unref(p),"on-label-click":t.onHeaderLabelClick}),null,16,["title","mode","value","on-label-click"]),e.createVNode(Z.default,{"week-list":W.value},null,8,["week-list"]),e.createVNode(x.default,{mode:e.unref(u),rows:H.value,value:e.unref(m)?void 0:t.value,"range-values":t.rangeValues,"disabled-date":t.disabledDate,"is-same-time":A.value,"date-render":t.dateRender,onCellClick:G,onCellMouseEnter:J},null,8,["mode","rows","value","range-values","disabled-date","is-same-time","date-render"])],2)):e.createCommentVNode("",!0),O.value?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(e.unref(s).e(`${a.value}-timepicker`))},[e.createElementVNode("header",{class:e.normalizeClass(e.unref(s).e(`${a.value}-timepicker-title`))},e.toDisplayString(e.unref(U)("tu.datepicker.selectTime")),3),e.createVNode(ee.default,e.mergeProps({...t.timePickerProps,...j.value},{"hide-footer":"",value:t.value||e.unref(m)?t.timePickerValue:void 0,disabled:t.disabled,onSelect:K}),null,16,["value","disabled"])],2)):e.createCommentVNode("",!0),d.value?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(e.unref(s).e(`${a.value}-footer`))},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).e(`${a.value}-view-tabs`))},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(s).e(`${a.value}-view-tab-pane`),{[e.unref(s).is("active")]:g.value}]),onClick:l[0]||(l[0]=y=>h("date"))},[e.createVNode(e.unref(L.TuIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(P.Calendar))]),_:1}),e.createElementVNode("span",{class:e.normalizeClass(`${a.value}-view-tab-pane-text`)},e.toDisplayString(e.unref(o)&&e.unref(o).format("YYYY-MM-DD")),3)],2),e.createElementVNode("div",{class:e.normalizeClass([`${a.value}-view-tab-pane`,{[`${a.value}-view-tab-pane-active`]:O.value}]),onClick:l[1]||(l[1]=()=>h("time"))},[e.createVNode(e.unref(L.TuIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(P.Clock))]),_:1}),e.createElementVNode("span",{class:e.normalizeClass(`${a.value}-view-tab-pane-text`)},e.toDisplayString(t.timePickerValue&&t.timePickerValue.format("HH:mm:ss")),3)],2)],2)],2)):e.createCommentVNode("",!0)],2))}});exports.default=ae;
