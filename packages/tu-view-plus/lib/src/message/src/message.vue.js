"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),c=require("@vueuse/core"),M=require("./message.js"),N=require("@tu-view-plus/constants"),S=require("@tu-view-plus/hooks");require("../../config-provider/index.js");const p=require("./instance.js"),L=require("@tu-view-plus/icons-vue"),v=require("../../icon/index.js"),E=require("../../badge/index.js");require("../style/message.css");const O=require("../../config-provider/src/hooks/use-global-config.js"),V=["id"],I=["innerHTML"],$=e.defineComponent({name:"TuMessage"}),_=e.defineComponent({...$,props:M.messageProps,setup(g,{expose:C}){const o=g,{ns:s,zIndex:k}=O.useGlobalComponentSettings("message"),{currentZIndex:y,nextZIndex:B}=k,l=e.ref(),n=e.ref(!1),i=e.ref(0);let r;const h=e.computed(()=>({[s.b()]:!0,[s.m(o.type)]:o.type,[s.is("center")]:o.center,[s.is("closable")]:o.showClose,[o.customClass]:!0})),T=e.computed(()=>p.getLastOffset(o.id)),d=e.computed(()=>p.getOffsetOrSpace(o.id,o.offset)+T.value),q=e.computed(()=>i.value+d.value),b=e.computed(()=>({top:`${d.value}px`,zIndex:y.value})),w=e.computed(()=>o.type?o.type==="error"?"danger":o.type:"info"),a=()=>{n.value=!1},m=()=>{r==null||r()},u=()=>{o.duration!==0&&({stop:r}=c.useTimeoutFn(()=>{a()},o.duration))},z=({code:t})=>{t===N.EVENT_CODE.esc&&a()};return e.onMounted(()=>{u(),B(),n.value=!0}),e.watch(()=>o.repeatNum,()=>{m(),u()}),c.useEventListener(document,"keydown",z),c.useResizeObserver(l,()=>{i.value=l.value.getBoundingClientRect().height}),C({visible:n,bottom:q,close:a}),(t,f)=>(e.openBlock(),e.createBlock(e.Transition,{name:`${e.unref(S.defaultNamespace)}-fade-in-linear`,onBeforeLeave:t.onClose,onAfterLeave:f[0]||(f[0]=D=>t.$emit("destroy"))},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{ref_key:"messageRef",ref:l,role:"alert",id:t.id,class:e.normalizeClass(h.value),style:e.normalizeStyle(b.value),onMouseenter:m,onMouseleave:u},[t.repeatNum>1?(e.openBlock(),e.createBlock(e.unref(E.TuBadge),{key:0,value:t.repeatNum,type:w.value,class:e.normalizeClass(e.unref(s).e("badge"))},null,8,["value","type","class"])):e.createCommentVNode("",!0),t.icon?(e.openBlock(),e.createBlock(e.unref(v.TuIcon),{key:1,class:e.normalizeClass([e.unref(s).e("icon")])},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.icon)))]),_:1},8,["class"])):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(e.unref(s).e("content")),innerHTML:t.message},null,10,I)):(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(e.unref(s).e("content"))},e.toDisplayString(t.message),3))]),t.showClose?(e.openBlock(),e.createBlock(e.unref(v.TuIcon),{key:2,class:e.normalizeClass(e.unref(s).em("icon","close")),onClick:e.withModifiers(a,["stop"])},{default:e.withCtx(()=>[e.createVNode(e.unref(L.Close))]),_:1},8,["class"])):e.createCommentVNode("",!0)],46,V),[[e.vShow,n.value]])]),_:3},8,["name","onBeforeLeave"]))}});exports.default=_;
