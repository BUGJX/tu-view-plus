"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),c=require("@vueuse/core"),M=require("./message.js"),S=require("@tu-view-plus/constants"),z=require("@tu-view-plus/hooks");require("../../config-provider/index.js");const p=require("./instance.js"),N=require("@tu-view-plus/icons-vue"),L=require("../../icon/index.js"),E=require("../../badge/index.js");require("../style/message.css");const O=require("../../config-provider/src/hooks/use-global-config.js"),V=["id"],_=["innerHTML"],$=e.defineComponent({name:"TuMessage"}),I=e.defineComponent({...$,props:M.messageProps,setup(v,{expose:g}){const t=v,{ns:s,zIndex:y}=O.useGlobalComponentSettings("message"),{currentZIndex:C,nextZIndex:k}=y,l=e.ref(),n=e.ref(!1),i=e.ref(0);let r;const h=e.computed(()=>({[s.b()]:!0,[s.m(t.type)]:t.type&&!t.icon,[s.is("center")]:t.center,[s.is("closable")]:t.showClose,[t.customClass]:!0})),B=e.computed(()=>p.getLastOffset(t.id)),d=e.computed(()=>p.getOffsetOrSpace(t.id,t.offset)+B.value),q=e.computed(()=>i.value+d.value),T=e.computed(()=>({top:`${d.value}px`,zIndex:C.value})),b=e.computed(()=>t.type?t.type==="error"?"danger":t.type:"info"),a=()=>{n.value=!1},f=()=>{r==null||r()},u=()=>{t.duration!==0&&({stop:r}=c.useTimeoutFn(()=>{a()},t.duration))},w=({code:o})=>{o===S.EVENT_CODE.esc&&a()};return e.onMounted(()=>{u(),k(),n.value=!0}),e.watch(()=>t.repeatNum,()=>{f(),u()}),c.useEventListener(document,"keydown",w),c.useResizeObserver(l,()=>{i.value=l.value.getBoundingClientRect().height}),g({visible:n,bottom:q,close:a}),(o,m)=>(e.openBlock(),e.createBlock(e.Transition,{name:`${e.unref(z.defaultNamespace)}-fade-in-linear`,onBeforeLeave:o.onClose,onAfterLeave:m[0]||(m[0]=R=>o.$emit("destroy"))},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{ref_key:"messageRef",ref:l,role:"alert",id:o.id,class:e.normalizeClass(e.unref(h)),style:e.normalizeStyle(e.unref(T)),onMouseenter:f,onMouseleave:u},[o.repeatNum>1?(e.openBlock(),e.createBlock(e.unref(E.TuBadge),{key:0,value:o.repeatNum,type:e.unref(b),class:e.normalizeClass(e.unref(s).e("badge"))},null,8,["value","type","class"])):e.createCommentVNode("",!0),e.renderSlot(o.$slots,"default",{},()=>[o.dangerouslyUseHTMLString?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(e.unref(s).e("content")),innerHTML:o.message},null,10,_)):(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(e.unref(s).e("content"))},e.toDisplayString(o.message),3))]),o.showClose?(e.openBlock(),e.createBlock(e.unref(L.TuIcon),{key:1,class:e.normalizeClass(e.unref(s).em("icon","close")),onClick:e.withModifiers(a,["stop"])},{default:e.withCtx(()=>[e.createVNode(e.unref(N.Close))]),_:1},8,["class","onClick"])):e.createCommentVNode("",!0)],46,V),[[e.vShow,n.value]])]),_:3},8,["name","onBeforeLeave"]))}});exports.default=I;
