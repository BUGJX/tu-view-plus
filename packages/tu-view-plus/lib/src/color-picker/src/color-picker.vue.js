"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const r=require("vue"),C=require("./color-picker.js"),h=require("@tu-view-plus/hooks"),i=require("@tu-view-plus/utils");require("../../form/index.js");const S=require("../../trigger/index.js"),_=require("./color-picker-panel.vue.js");require("../style/color-picker.css");const V=require("../../form/src/hooks/use-form-props.js"),x=r.defineComponent({name:"TuColorPicker",props:C.colorPickerProps,emits:C.colorPickerEmits,setup(o,{emit:v,slots:b}){const t=h.useNamespace("color-picker"),m=V.useFormSize(),l=V.useFormDisabled(),$=r.computed(()=>o.modelValue??o.defaultValue),n=r.computed(()=>i.formatInputToHSVA($.value||"")),[u,p]=h.useState(n.value.a),[d,P]=h.useState({h:n.value.h,s:n.value.s,v:n.value.v});r.watch(()=>n.value,e=>{p(e.a),P({h:e.h,s:e.s,v:e.v})});const g=r.computed(()=>{const e=i.hsvToRgb(d.value.h,d.value.s,d.value.v),a=i.rgbToHex(e.r,e.g,e.b);return{hsv:d.value,rgb:e,hex:a}}),k=r.computed(()=>{const{r:e,g:a,b:s}=g.value.rgb;return`rgba(${e}, ${a}, ${s}, ${u.value.toFixed(2)})`}),c=r.computed(()=>{const{r:e,g:a,b:s}=g.value.rgb;return o.format==="rgb"?u.value<1&&!o.disabledAlpha?`rgba(${e}, ${a}, ${s}, ${u.value.toFixed(2)})`:`rgb(${e}, ${a}, ${s})`:u.value<1&&!o.disabledAlpha?`#${i.rgbaToHex(e,a,s,u.value)}`:`#${i.rgbToHex(e,a,s)}`}),T=r.computed(()=>({[t.b()]:!0,[t.m(m.value)]:m.value,[t.is("disabled")]:l.value}));r.watch(c,e=>{v("update:modelValue",e),v("change",e)});const q=e=>{!l.value&&P(e)},w=e=>{!l.value&&p(e)},H=e=>{v("popup-visible-change",e,c.value)},N=()=>r.createVNode("div",{class:T.value},[r.createVNode("div",{class:t.e("preview")},[r.createVNode("div",{class:t.e("preview-inner"),style:{backgroundColor:c.value}},null)]),o.showText&&r.createVNode("div",{class:t.e("value")},[c.value]),r.createVNode("input",{class:t.e("input"),value:c.value,disabled:l.value},null)]),f=()=>r.createVNode(_.default,{color:g.value,alpha:u.value,colorString:k.value,historyColors:o.historyColors,presetColors:o.presetColors,showHistory:o.showHistory,showPreset:o.showPreset,disabled:l.value,disabledAlpha:o.disabledAlpha,format:o.format,onHsvChange:q,onAlphaChange:w},null);return()=>o.hideTrigger?f():r.createVNode(S.TuTrigger,r.mergeProps({trigger:"click",position:"bl",animationName:"slide-dynamic-origin",popupOffset:10,disabled:l.value},o.triggerProps,{onPopupVisibleChange:H}),{default:()=>[b.default?b.default():N()],content:f})}});exports.default=x;
