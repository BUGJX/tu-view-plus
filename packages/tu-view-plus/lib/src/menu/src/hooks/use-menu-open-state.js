"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("vue"),g=require("@tu-view-plus/utils");function K(a,n){const s=[],i=p=>{for(let u=0;u<p.length;u++){const o=p[u];if(o.key===n)return!0;if(o.children){if(s.push(o.key),i(o.children))return!0;s.pop()}}return!1};return i(a),s}function w(a,n){return a.length!==n.length?!1:a.toString()===n.toString()}function M(a){const{modelValue:n,defaultValue:s,autoOpen:i,autoOpenSelected:p,subMenuKeys:u,selectedKeys:o,menuData:O,accordion:c}=r.toRefs(a),h=r.ref(g.isUndefined(n.value)?g.isUndefined(s.value)?[]:s.value:n.value),f=e=>{h.value=e};r.watch(n,()=>{g.isUndefined(n.value)&&f([])});let m=[];r.onMounted(()=>{m=[...u.value];let e=[];if(i.value&&(e=c.value?u.value.slice(0,1):[...u.value]),p.value){const l=o.value.map(t=>K(O.value,t));l.length&&(!i.value||c.value)&&(e=c.value?l[0]:[...new Set([].concat(...l))])}e.length&&f(e)});let S=!1;r.watch(u,(e,l=[])=>{if(S||!w(e,m)){const t=v.value.filter(d=>e.includes(d));if(i.value){const d=e.filter(y=>!l.includes(y));t.push(...d)}f(c.value?t.slice(0,1):t)}S=!0});const v=r.computed(()=>n.value||h.value);return{openKeys:v,localOpenKeys:h,setOpenKeys:f,open(e,l){let t=[];return v.value.indexOf(e)>-1?c.value&&l===1?t=[]:t=v.value.filter(d=>d!==e):c.value&&l===1?t=[e]:t=v.value.concat([e]),f(t),t}}}exports.useMenuOpenState=M;
