"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),B=require("./base-menu.js"),c=require("@tu-view-plus/hooks"),i=require("@tu-view-plus/utils"),S=require("@tu-view-plus/icons-vue"),oe=require("./hooks/use-level.js"),ne=require("./context.js"),se=require("./hooks/use-menu-data-collector.js"),ue=require("./hooks/use-menu-open-state.js"),le=require("../../icon/index.js"),ae=require("../../button/index.js");require("../style/menu.css");const ce=e.defineComponent({name:"TuBaseMenu",inheritAttrs:!1}),re=e.defineComponent({...ce,props:B.baseMenuProps,emits:B.baseMenuEmits,setup(K,{emit:h}){const b=K,u=h,k=e.useSlots(),o=c.useNamespace("menu"),{style:p,mode:s,effect:y,levelIndent:q,accordion:x,showCollapseButton:O,scrollConfig:_,autoScrollIntoView:w,collapsedWidth:l,autoOpen:I,collapsed:P,defaultCollapsed:d,selectedKeys:z,defaultSelectedKeys:T,openKeys:N,defaultOpenKeys:D,triggerProps:E,tooltipProps:V,autoOpenSelected:$,breakpoint:j,popupMaxHeight:H,inTrigger:v,siderCollapsed:m,isRoot:f}=e.toRefs(b),{subMenuKeys:L,menuData:R}=se.useMenuDataCollector({type:f!=null&&f.value?"menu":"popupMenu"}),[M,A]=c.useMergeState(T.value,e.reactive({value:z})),{openKeys:F,setOpenKeys:U,open:G}=ue.useMenuOpenState(e.reactive({modelValue:N,defaultValue:D,autoOpen:I,autoOpenSelected:$,selectedKeys:M,subMenuKeys:L,menuData:R,accordion:x})),[C,J]=c.useMergeState(d==null?void 0:d.value,e.reactive({value:P})),a=e.computed(()=>(m==null?void 0:m.value)||C.value||s.value==="popButton"),Q=e.computed(()=>["horizontal","popButton"].indexOf(s.value)<0&&!v.value&&O.value),X=e.computed(()=>({[o.b()]:!0,[o.m("horizontal")]:s.value==="horizontal",[o.m("vertical")]:s.value==="vertical",[o.m("trigger")]:v.value,[o.m(y.value)]:y.value,[o.is("pop")]:s.value==="pop"||a.value,[o.is("pop-button")]:s.value==="popButton",[o.is("collapsed")]:a.value})),Y=e.computed(()=>{const t=i.isNumber(l==null?void 0:l.value)?i.addUnit(l==null?void 0:l.value):void 0,n=i.isObject(p.value)?p.value:void 0,r=a.value?t:n==null?void 0:n.width;return[n?i.omit(n,["width"]):p.value,{width:r}]}),g=(t,n)=>{t!==C.value&&(J(t),u("update:collapsed",t),u("collapse",t,n))},Z=()=>{g(!C.value,"clickTrigger")};c.useResponsive(j,t=>{g(!t,"responsive")});const W=c.usePickSlots(k,"expand-icon-down"),ee=c.usePickSlots(k,"expand-icon-right"),te=e.reactive({mode:s,levelIndent:q,autoScrollIntoView:w,selectedKeys:M,openKeys:F,scrollConfig:_,inTrigger:v,collapsed:a,triggerProps:E,tooltipProps:V,popupMaxHeight:H,expandIconDown:W,expandIconRight:ee,onMenuItemClick:t=>{A([t]),u("update:selectedKeys",[t]),u("menu-item-click",t)},onSubMenuClick:(t,n)=>{const r=G(t,n);U(r),u("update:openKeys",r),u("sub-menu-click",t,r)}});return e.provide(ne.MenuInjectionKey,te),oe.provideLevel(1),(t,n)=>(e.openBlock(),e.createElementBlock("div",e.mergeProps(t.$attrs,{class:X.value,style:Y.value}),[e.createElementVNode("div",{class:e.normalizeClass(e.unref(o).e("inner"))},[e.renderSlot(t.$slots,"default")],2),Q.value?(e.openBlock(),e.createBlock(e.unref(ae.TuButton),{key:0,size:"small",class:e.normalizeClass(e.unref(o).e("collapse-button")),onClick:Z},{default:e.withCtx(()=>[e.renderSlot(t.$slots,"collapse-icon",{collapsed:a.value},()=>[e.createVNode(e.unref(le.TuIcon),null,{default:e.withCtx(()=>[a.value?(e.openBlock(),e.createBlock(e.unref(S.Expand),{key:0})):(e.openBlock(),e.createBlock(e.unref(S.Fold),{key:1}))]),_:1})])]),_:3},8,["class"])):e.createCommentVNode("",!0)],16))}});exports.default=re;
