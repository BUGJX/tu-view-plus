"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),W=require("@tu-view-plus/hooks"),g=require("@tu-view-plus/utils"),x=require("./sub-menu.vue.js");require("../style/menu.css");const C=10;function O(i){return i&&+i.getBoundingClientRect().width.toFixed(2)}function V(i){const b=Number(i.replace("px",""));return Number.isNaN(b)?0:b}const I=e.defineComponent({name:"TuOverflowWrap",setup(i,{attrs:b,slots:M}){const d=W.useNamespace("menu"),N=d.e("sub-menu"),S=d.e("sub-menu-mirror"),f=e.ref(),o=e.ref(null),m=e.ref();function _(){const r=f.value,h=O(r),s=[].slice.call(r.children);let t=0,n=0,l=0;for(let c=0;c<s.length;c++){const u=s[c],v=u.className.split(" "),a=v.indexOf(N)>-1,w=v.indexOf(S)>-1;if(a)continue;const p=O(u)+V(g.getStyle(u,"marginLeft"))+V(g.getStyle(u,"marginRight"));if(w){l=p;continue}if(n+=p,n+l+C>h){o.value=t-1;return}t++}o.value=null}return e.onMounted(()=>{_(),m.value=new ResizeObserver(r=>{r.forEach(_)}),f.value&&m.value.observe(f.value)}),e.onUnmounted(()=>{m.value&&m.value.disconnect()}),()=>{const r=(s,t)=>{const{isMirror:n=!1,props:l={}}=t||{};return e.createVNode(x.default,e.mergeProps({key:`__tu-menu-overflow-sub-menu${n?"-mirror":""}`,class:n?S:N},l),{title:()=>e.createVNode("span",null,[e.createTextVNode("...")]),default:()=>s})},h=()=>{var u;const s=((u=M.default)==null?void 0:u.call(M))||[],t=g.unFragment(s);let n=null;const l=r(null,{isMirror:!0}),c=t.map((v,a)=>{const w=e.cloneVNode(v,o.value!==null&&a>o.value?{class:d.e("hidden-menu-item")}:{class:""});if(o.value!==null&&a===o.value+1){const p=t.slice(a).map(R=>e.cloneVNode(R));n=r(p)}return w});return[l,...c,n]};return e.createVNode("div",{class:d.e("overflow-wrap"),ref:f},[h()])}}});exports.default=I;
