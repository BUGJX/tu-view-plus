"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),U=require("@tu-view-plus/hooks"),j=require("@tu-view-plus/utils"),V=require("./tabs-nav.js"),A=require("@tu-view-plus/icons-vue"),R=require("./tabs-button.vue.js"),G=require("./tabs-tab.vue.js"),J=require("./tabs-nav-indicate.vue.js"),Q=require("../../icon/index.js"),x=require("../../resize-observer/index.js"),h=require("./utils.js");require("../style/tabs.css");const X=e.defineComponent({name:"TuTabsNav"}),Y=e.defineComponent({...X,props:V.tabsNavProps,emits:V.tabsNavEmits,setup(z,{emit:q}){const r=z,_=q,{tabs:b,activeKey:d,activeIndex:w,direction:i}=e.toRefs(r),s=U.useNamespace("tabs"),o=e.ref(),u=e.ref(),y=e.ref({}),g=e.ref(),c=e.ref(!1),p=e.ref(0),f=e.ref(0),v=e.ref([]),n=e.ref(0),C=e.computed(()=>{if(!j.isUndefined(d==null?void 0:d.value))return y.value[d.value]}),E=e.computed(()=>({[s.e("nav")]:!0,[s.em("nav",r.direction)]:r.direction,[s.em("nav",r.position)]:r.position,[s.em("nav",r.type)]:r.type})),O=e.computed(()=>({[s.e("nav-tab")]:!0,[s.em("nav-tab","scroll")]:c.value})),B=e.computed(()=>r.direction==="horizontal"?h.gap:h.gap-4),S=e.computed(()=>h.getTabListStyle({direction:r.direction,type:r.type,offset:n.value,gap:B.value})),W=t=>!o.value||!u.value||t<0?0:t>f.value?f.value:t,H=t=>o.value?t==="previous"?n.value-p.value:n.value+p.value:0,I=()=>o.value&&u.value?r.direction==="vertical"?u.value.offsetHeight>o.value.offsetHeight:u.value.offsetWidth>o.value.offsetWidth:!1,$=()=>{var t,a;return(i.value==="vertical"?(t=o.value)==null?void 0:t.offsetHeight:(a=o.value)==null?void 0:a.offsetWidth)??0},L=()=>!u.value||!o.value?0:i.value==="vertical"?u.value.offsetHeight-o.value.offsetHeight:u.value.offsetWidth-o.value.offsetWidth,D=()=>b.value.map(t=>{const a=y.value[t.key];return i.value==="vertical"?a.offsetTop+a.offsetHeight:a.offsetLeft+a.offsetWidth}),N=t=>(v.value[t-1]??0)>=n.value&&v.value[t]<=n.value+p.value,T=t=>{n.value=W(H(t))},m=()=>{c.value=I(),c.value?(p.value=$(),f.value=L(),v.value=D(),n.value>f.value&&(n.value=f.value)):n.value=0},M=()=>{m(),g.value&&g.value.$forceUpdate()},P=(t,a)=>{_("click",t,a)},F=(t,a)=>{_("delete",t,a)};return e.watch(b,()=>{e.nextTick(()=>m())}),e.watch(w,(t,a)=>{e.nextTick(()=>{if(c.value)if(t>=a){const l=t<v.value.length-1?t+1:t;N(l)||(n.value=v.value[l]-p.value+B.value)}else{const l=t>0?t-1:t;N(l)||(n.value=v.value[l-1]??0)}})}),e.onMounted(()=>{m()}),(t,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(E.value)},[c.value?(e.openBlock(),e.createBlock(R.default,{key:0,type:"previous",direction:e.unref(i),disabled:n.value<=0,onClick:T},null,8,["direction","disabled"])):e.createCommentVNode("",!0),e.createVNode(e.unref(x.TuResizeObserver),{onResize:m},{default:e.withCtx(()=>[e.createElementVNode("div",{ref_key:"wrapperRef",ref:o,class:e.normalizeClass(O.value)},[e.createVNode(e.unref(x.TuResizeObserver),{onResize:M},{default:e.withCtx(()=>[e.createElementVNode("div",{ref_key:"listRef",ref:u,class:e.normalizeClass(e.unref(s).e("nav-tab-list")),style:e.normalizeStyle(S.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),l=>(e.openBlock(),e.createBlock(G.default,{key:l.key,ref_for:!0,ref:k=>{k!=null&&k.$el&&(y.value[l.key]=k.$el)},active:l.key===e.unref(d),tab:l,editable:t.editable,onClick:P,onDelete:F},{default:e.withCtx(()=>[l.slots.title?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.slots.title),{key:0})):e.createCommentVNode("",!0),l.title?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(l.title),1)],64)):e.createCommentVNode("",!0)]),_:2},1032,["active","tab","editable"]))),128)),C.value?(e.openBlock(),e.createBlock(J.default,{key:0,ref_key:"indicateRef",ref:g,activeTabRef:C.value,direction:e.unref(i),disabled:!1,animation:t.animation},null,8,["activeTabRef","direction","animation"])):e.createCommentVNode("",!0)],6)]),_:1})],2)]),_:1}),c.value?(e.openBlock(),e.createBlock(R.default,{key:1,type:"next",direction:e.unref(i),disabled:n.value>=f.value,onClick:T},null,8,["direction","disabled"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).e("nav-extra"))},[t.showAddButton?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(s).e("button-add")),onClick:a[0]||(a[0]=l=>_("add",l))},[e.createVNode(e.unref(Q.TuIcon),null,{default:e.withCtx(()=>[e.createVNode(e.unref(A.CirclePlus))]),_:1})],2)):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"extra")],2)],2))}});exports.default=Y;
