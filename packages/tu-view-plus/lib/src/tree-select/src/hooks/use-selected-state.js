"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const u=require("vue"),V=require("@tu-view-plus/utils");function w(e){return V.isObject(e)}function P(e){return e!=null&&e!==""}function j(e){return w(e)?e.value:e}function G(e){return w(e)?e.label:void 0}function D(e){const a=j(e);return P(a)}function F(e){return e.map(j).filter(P)}function H(e){const{defaultValue:a,modelValue:n,key2TreeNode:m,multiple:S,treeCheckable:h,fallbackOption:s,fieldNames:M}=u.toRefs(e);function p(t){const l=(V.isArray(t)?t:[t]).filter(D);return S!=null&&S.value||h!=null&&h.value?l:l.slice(0,1)}function r(t,l){const i=[],q=t?t.filter(D):[];if(q.length){const R=new Map;l==null||l.forEach(c=>{R.set(c.value,c)}),q.forEach(c=>{var A;const v=j(c),f=R.get(v),y=m.value.get(v);let K=null;const C=((A=M==null?void 0:M.value)==null?void 0:A.title)||"title";if(!y){const L=V.isFunction(s==null?void 0:s.value)?s==null?void 0:s.value(v):s==null?void 0:s.value;if(L===!1)return;V.isObject(L)&&(K=L)}i.push({...w(c)?c:{},...f||{},value:v,label:G(c)??(y==null?void 0:y.title)??(f==null?void 0:f.label)??(K==null?void 0:K[C])??v})})}return i}const b=u.ref(),g=u.ref();u.watchEffect(()=>{const t=(n==null?void 0:n.value)!==void 0,l=p((n==null?void 0:n.value)??[]),i=F(l);g.value=t?r(i,r(l)):void 0,b.value=t?i:void 0});const z=p((a==null?void 0:a.value)??[]),E=F(z),T=r(E,r(z)),o=u.ref(E||[]),d=u.ref(T);u.watch(o,()=>{d.value=r(o.value,T)}),u.watch([b,g],([t,l])=>{o.value=t||[],d.value=l||[]});const x=u.computed(()=>b.value??o.value),B=u.computed(()=>g.value??d.value);return{selectedKeys:x,selectedValue:B,setLocalSelectedKeys(t){o.value=t},localSelectedKeys:o,localSelectedValue:d}}exports.useSelectedState=H;
