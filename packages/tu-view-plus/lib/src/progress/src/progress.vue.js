"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),x=require("./progress.js"),k=require("@tu-view-plus/hooks"),h=require("@tu-view-plus/utils"),u=require("@tu-view-plus/icons-vue");require("../style/progress.css");const I=["aria-valuenow"],_={viewBox:" 0 0 100 100"},q=["d","stroke-width"],W=["d","stroke","stroke-width","stroke-linecap","opacity"],F={key:0},M=e.defineComponent({name:"TuProgress"}),O=e.defineComponent({...M,props:x.progressProps,setup(w){const r=w,g={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=k.useNamespace("progress"),n=k.useNamespace("progress-bar"),p=k.useNamespace("progress-circle"),S=e.computed(()=>({[a.b()]:!0,[a.m(r.type)]:r.type,[a.m("without-text")]:!r.showText,[a.m("text-inside")]:r.textInside,[a.is(r.status)]:r.status})),B=e.computed(()=>({[n.e("outer")]:!0,[n.is("narrow")]:r.strokeWidth<6})),b=e.computed(()=>({[n.e("inner")]:!0,[n.em("inner","indeterminate")]:r.indeterminate,[n.em("inner","striped")]:r.striped,[n.em("inner","striped-flow")]:r.stripedFlow})),z=e.computed(()=>({width:`${r.percentage}%`,animationDuration:`${r.duration}s`,backgroundColor:d(r.percentage)}));e.computed(()=>({width:`${r.percentage}%`,animationDuration:`${r.duration}s`,backgroundColor:d(r.percentage)}));const d=t=>{var i;const{color:s}=r;if(h.isFunction(s))return s(t);if(h.isString(s))return s;{const o=E(s);for(const l of o)if(l.percentage>t)return l.color;return(i=o[o.length-1])==null?void 0:i.color}},E=t=>{const s=100/t.length;return t.map((o,l)=>h.isString(o)?{color:o,percentage:(l+1)*s}:o).sort((o,l)=>o.percentage-l.percentage)},y=e.computed(()=>r.format(r.percentage)),m=e.computed(()=>(r.strokeWidth/r.width*100).toFixed(1)),C=e.computed(()=>["circle","dashboard"].includes(r.type)?Number.parseInt(`${50-Number.parseFloat(m.value)/2}`,10):0),v=e.computed(()=>{const t=C.value,s=r.type==="dashboard";return`
          M 50 50
          m 0 ${s?"":"-"}${t}
          a ${t} ${t} 0 1 1 0 ${s?"-":""}${t*2}
          a ${t} ${t} 0 1 1 0 ${s?"":"-"}${t*2}
          `}),c=e.computed(()=>2*Math.PI*C.value),f=e.computed(()=>r.type==="dashboard"?.75:1),$=e.computed(()=>`${-1*c.value*(1-f.value)/2}px`),N=e.computed(()=>({strokeDasharray:`${c.value*f.value}px, ${c.value}px`,strokeDashoffset:$.value})),D=e.computed(()=>{let t;return r.color?t=d(r.percentage):t=g[r.status]||g.default,t}),P=e.computed(()=>({strokeDasharray:`${c.value*f.value*(r.percentage/100)}px, ${c.value}px`,strokeDashoffset:$.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),T=e.computed(()=>r.type==="line"?12+r.strokeWidth*.4:r.width*.111111+2),V=e.computed(()=>r.status==="warning"?u.WarningFilled:r.type==="line"?r.status==="success"?u.CircleCheck:u.CircleClose:r.status==="success"?u.Check:u.Close);return(t,s)=>{const i=e.resolveComponent("tu-icon");return e.openBlock(),e.createElementBlock("div",{role:"progressbar",class:e.normalizeClass(e.unref(S)),"aria-valuenow":t.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[t.type==="line"?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(n).b())},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(B)),style:e.normalizeStyle({height:`${t.strokeWidth}px`})},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(b)),style:e.normalizeStyle(e.unref(z))},[(t.showText||t.$slots.default)&&t.textInside?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(n).e("innerText"))},[e.renderSlot(t.$slots,"default",{percentage:t.percentage},()=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(y)),1)])],2)):e.createCommentVNode("",!0)],6)],6)],2)):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(e.unref(p).b()),style:e.normalizeStyle({height:`${t.width}px`,width:`${t.width}px`})},[(e.openBlock(),e.createElementBlock("svg",_,[e.createElementVNode("path",{class:e.normalizeClass(e.unref(p).m("track")),d:e.unref(v),stroke:"#c8d0e761","stroke-width":e.unref(m),style:e.normalizeStyle(e.unref(N)),fill:"none"},null,14,q),e.createElementVNode("path",{class:e.normalizeClass(e.unref(p).m("path")),d:e.unref(v),stroke:e.unref(D),"stroke-width":e.unref(m),"stroke-linecap":t.strokeLinecap,opacity:t.percentage?1:0,style:e.normalizeStyle(e.unref(P)),fill:"none"},null,14,W)]))],6)),(t.showText||t.$slots.default)&&!t.textInside?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(e.unref(a).e("text")),style:e.normalizeStyle({fontSize:`${e.unref(T)}px`})},[e.renderSlot(t.$slots,"default",{percentage:t.percentage},()=>[t.status?(e.openBlock(),e.createBlock(i,{key:1},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(V))))]),_:1})):(e.openBlock(),e.createElementBlock("span",F,e.toDisplayString(e.unref(y)),1))])],6)):e.createCommentVNode("",!0)],10,I)}}});exports.default=O;
