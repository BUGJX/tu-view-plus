"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),I=require("./progress.js"),f=require("@tu-view-plus/hooks"),k=require("@tu-view-plus/utils"),u=require("@tu-view-plus/icons-vue");require("../style/progress.css");const _=["aria-valuenow"],W={viewBox:" 0 0 100 100"},q=["d","stroke-width"],F=["d","stroke","stroke-width","stroke-linecap","opacity"],M={key:0},O=e.defineComponent({name:"TuProgress"}),A=e.defineComponent({...O,props:I.progressProps,setup(w){const s=w,h={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=f.useNamespace("progress"),n=f.useNamespace("progress-bar"),p=f.useNamespace("progress-circle"),S=e.computed(()=>({[a.b()]:!0,[a.m(s.type)]:s.type,[a.m("without-text")]:!s.showText,[a.m("text-inside")]:s.textInside,[a.is(s.status)]:s.status})),B=e.computed(()=>({[n.e("outer")]:!0,[n.is("narrow")]:s.strokeWidth<6})),z=e.computed(()=>({[n.e("inner")]:!0,[n.em("inner","indeterminate")]:s.indeterminate,[n.em("inner","striped")]:s.striped,[n.em("inner","striped-flow")]:s.stripedFlow})),b=e.computed(()=>({[p.b()]:!0,[p.is("narrow")]:s.strokeWidth<6})),E=e.computed(()=>({width:`${s.percentage}%`,animationDuration:`${s.duration}s`,backgroundColor:g(s.percentage)})),g=t=>{var i;const{color:r}=s;if(k.isFunction(r))return r(t);if(k.isString(r))return r;{const o=N(r);for(const l of o)if(l.percentage>t)return l.color;return(i=o[o.length-1])==null?void 0:i.color}},N=t=>{const r=100/t.length;return t.map((o,l)=>k.isString(o)?{color:o,percentage:(l+1)*r}:o).sort((o,l)=>o.percentage-l.percentage)},y=e.computed(()=>s.format(s.percentage)),d=e.computed(()=>(s.strokeWidth/s.width*100).toFixed(1)),C=e.computed(()=>["circle","dashboard"].includes(s.type)?Number.parseInt(`${50-Number.parseFloat(d.value)/2}`,10):0),v=e.computed(()=>{const t=C.value,r=s.type==="dashboard";return`
          M 50 50
          m 0 ${r?"":"-"}${t}
          a ${t} ${t} 0 1 1 0 ${r?"-":""}${t*2}
          a ${t} ${t} 0 1 1 0 ${r?"":"-"}${t*2}
          `}),c=e.computed(()=>2*Math.PI*C.value),m=e.computed(()=>s.type==="dashboard"?.75:1),$=e.computed(()=>`${-1*c.value*(1-m.value)/2}px`),P=e.computed(()=>({strokeDasharray:`${c.value*m.value}px, ${c.value}px`,strokeDashoffset:$.value})),D=e.computed(()=>{let t;return s.color?t=g(s.percentage):t=h[s.status]||h.default,t}),T=e.computed(()=>({strokeDasharray:`${c.value*m.value*(s.percentage/100)}px, ${c.value}px`,strokeDashoffset:$.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),V=e.computed(()=>s.type==="line"?12+s.strokeWidth*.4:s.width*.111111+2),x=e.computed(()=>s.status==="warning"?u.WarningFilled:s.type==="line"?s.status==="success"?u.CircleCheck:u.CircleClose:s.status==="success"?u.Check:u.Close);return(t,r)=>{const i=e.resolveComponent("tu-icon");return e.openBlock(),e.createElementBlock("div",{role:"progressbar",class:e.normalizeClass(e.unref(S)),"aria-valuenow":t.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[t.type==="line"?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(n).b())},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(B)),style:e.normalizeStyle({height:`${t.strokeWidth}px`})},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(z)),style:e.normalizeStyle(e.unref(E))},[(t.showText||t.$slots.default)&&t.textInside?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(n).e("innerText"))},[e.renderSlot(t.$slots,"default",{percentage:t.percentage},()=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(y)),1)])],2)):e.createCommentVNode("",!0)],6)],6)],2)):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(e.unref(b)),style:e.normalizeStyle({height:`${t.width}px`,width:`${t.width}px`})},[(e.openBlock(),e.createElementBlock("svg",W,[e.createElementVNode("path",{class:e.normalizeClass(e.unref(p).m("track")),d:e.unref(v),stroke:"#c8d0e761","stroke-width":e.unref(d),style:e.normalizeStyle(e.unref(P)),fill:"none"},null,14,q),e.createElementVNode("path",{class:e.normalizeClass(e.unref(p).m("path")),d:e.unref(v),stroke:e.unref(D),"stroke-width":e.unref(d),"stroke-linecap":t.strokeLinecap,opacity:t.percentage?1:0,style:e.normalizeStyle(e.unref(T)),fill:"none"},null,14,F)]))],6)),(t.showText||t.$slots.default)&&!t.textInside?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(e.unref(a).e("text")),style:e.normalizeStyle({fontSize:`${e.unref(V)}px`})},[e.renderSlot(t.$slots,"default",{percentage:t.percentage},()=>[t.status?(e.openBlock(),e.createBlock(i,{key:1},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(x))))]),_:1})):(e.openBlock(),e.createElementBlock("span",M,e.toDisplayString(e.unref(y)),1))])],6)):e.createCommentVNode("",!0)],10,_)}}});exports.default=A;
