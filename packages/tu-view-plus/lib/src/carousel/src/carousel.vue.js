"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),y=require("./carousel.js"),A=require("@tu-view-plus/hooks"),b=require("@tu-view-plus/utils"),D=require("./carousel-indicator.vue.js"),F=require("./carousel-arrow.vue.js"),H=require("./constants.js");require("../style/carousel.css");const K=e.defineComponent({name:"TuCarousel",props:y.carouselProps,emits:y.carouselEmits,setup(t,{emit:h,slots:d}){const o=A.useNamespace("carousel"),{current:N,animationName:q,moveSpeed:_,transitionTimingFunction:M}=e.toRefs(t),P={interval:3e3,hoverToPause:!0},v=e.ref(!1),m=e.ref(),g=e.ref(),w=e.computed(()=>b.isObject(t.autoPlay)?{...P,...t.autoPlay}:t.autoPlay?P:{});let f=0,x=0;const{children:C,components:i}=A.useChildrenComponents("TuCarouselItem"),c=e.ref(t.defaultCurrent-1),u=e.computed(()=>{const n=i.value.length,a=b.isNumber(N.value)?I(N.value-1,n):c.value,r=I(a-1,n),s=I(a+1,n);return{mergedIndex:a,mergedPrevIndex:r,mergedNextIndex:s}}),l=({targetIndex:n,isNegative:a=!1,isManual:r=!1})=>{!x&&n!==u.value.mergedIndex&&(m.value=c.value,c.value=n,g.value=a?"negative":"positive",x=window.setTimeout(()=>{x=0},_.value),h("updateCurrent",c.value+1),h("change",c.value+1,m.value+1,r))},V=e.reactive({items:i,slideTo:l,mergedIndexes:u,previousIndex:m,animationName:q,slideDirection:g,transitionTimingFunction:M,moveSpeed:_});e.provide(H.carouselInjectionKey,V);const T=()=>{f&&window.clearInterval(f)};function I(n,a){const r=+n;return typeof r=="number"&&!Number.isNaN(r)?(r+a)%a:n}const k=()=>{l({targetIndex:u.value.mergedPrevIndex,isNegative:!0,isManual:!0})},S=()=>{l({targetIndex:u.value.mergedNextIndex,isManual:!0})},j=n=>{l({targetIndex:n,isNegative:n<u.value.mergedIndex,isManual:!0})},E=e.computed(()=>w.value.hoverToPause?{onMouseenter:()=>{v.value=!0},onMouseleave:()=>{v.value=!1}}:{}),L=e.computed(()=>t.indicatorType!=="never"&&i.value.length>1),O=e.computed(()=>t.showArrow!=="never"&&i.value.length>1),U=e.computed(()=>({[o.b()]:!0,[o.m(`indicator-position-${t.indicatorPosition}`)]:t.indicatorPosition})),$=e.computed(()=>({[o.m(`${t.animationName}`)]:t.animationName,[o.m(`${t.direction}`)]:t.direction,[o.m("negative")]:g.value==="negative"})),B=e.computed(()=>({[o.e("indicator-wrapper")]:!0,[o.em("indicator-wrapper",t.indicatorPosition)]:t.indicatorPosition}));return e.watchEffect(()=>{var s;const{interval:n}=w.value||{},{mergedNextIndex:a}=u.value,r=((s=i.value)==null?void 0:s.length)>1&&!v.value&&!!n;T(),r&&(f=window.setInterval(()=>{l({targetIndex:a})},n))}),e.onBeforeUnmount(()=>{T()}),()=>{var n;return C.value=(n=d.default)==null?void 0:n.call(d),e.createVNode("div",e.mergeProps({class:U.value},E.value),[e.createVNode("div",{class:$.value},[C.value]),L.value&&e.createVNode("div",{class:B.value},[e.createVNode(D.default,{class:t.indicatorClasses,type:t.indicatorType,count:i.value.length,activeIndex:u.value.mergedIndex,position:t.indicatorPosition,trigger:t.trigger,onSelect:j},null)]),O.value&&e.createVNode(F.default,{class:t.arrowClass,direction:t.direction,showArrow:t.showArrow,onPreviousClick:k,onNextClick:S},null)])}}});exports.default=K;
