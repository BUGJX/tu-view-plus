"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),M=require("./resize-box.js"),_=require("@tu-view-plus/hooks"),r=require("@tu-view-plus/utils"),$=require("../../resize-trigger/index.js"),d=require("./interface.js");require("../style/resize-box.css");const L=e.defineComponent({name:"TuResizeBox",inheritAttrs:!1}),U=e.defineComponent({...L,props:M.resizeBoxProps,emits:M.resizeBoxEmits,setup(P,{emit:N}){const x=P,u=N,b=_.useNamespace("resize-box"),{height:D,width:H,directions:S}=e.toRefs(x),f=e.ref(0),m=e.ref(0),[k,O]=_.useMergeState(null,e.reactive({value:H})),[y,B]=_.useMergeState(null,e.reactive({value:D})),v=e.ref(),q=e.computed(()=>S.value.filter(t=>d.allDirections.includes(t))),C=e.reactive({}),W=e.computed(()=>({...r.isNumber(k.value)?{width:r.addUnit(k.value)}:{},...r.isNumber(y.value)?{height:r.addUnit(y.value)}:{},left:r.addUnit(f.value),top:r.addUnit(m.value),...C})),w=t=>[d.DIRECTION_TOP,d.DIRECTION_BOTTOM].indexOf(t)>-1,I=(t,i)=>{if(t===0)return 0;const o=t-i;return o<=0?0:o},s={direction:"",startPageX:0,startPageY:0,startWidth:0,startHeight:0,startLeft:0,startTop:0,moving:!1,padding:{left:0,right:0,top:0,bottom:0}},X=(t,i)=>{var p,h;u("movingStart",i),s.moving=!0,s.startPageX=i.pageX,s.startPageY=i.pageY,s.direction=t,s.startLeft=f.value,s.startTop=m.value;const{top:o,left:n,right:a,bottom:T}=s.padding;s.startWidth=I(((p=v.value)==null?void 0:p.clientWidth)||0,n+a),s.startHeight=I(((h=v.value)==null?void 0:h.clientHeight)||0,o+T),r.on(window,"mousemove",E),r.on(window,"mouseup",g),r.on(window,"contextmenu",g),document.body.style.cursor=w(t)?"row-resize":"col-resize"},E=t=>{if(!s.moving)return;const{startPageX:i,startPageY:o,startWidth:n,startHeight:a,direction:T,startLeft:p,startTop:h}=s;let l=n,c=a;const z=t.pageX-i,R=t.pageY-o;switch(T){case d.DIRECTION_LEFT:l=n-z,O(l),f.value=p+z,u("update:width",l);break;case d.DIRECTION_RIGHT:l=n+z,O(l),u("update:width",l);break;case d.DIRECTION_TOP:c=a-R,B(c),m.value=h+R,u("update:height",c);break;case d.DIRECTION_BOTTOM:c=a+R,B(c),u("update:height",c);break}u("moving",{width:l,height:c},t)},g=t=>{s.moving=!1,r.off(window,"mousemove",E),r.off(window,"mouseup",g),r.off(window,"contextmenu",g),document.body.style.cursor="default",u("movingEnd",t)},Y=(t,i)=>{const{width:o,height:n}=i.contentRect,a=w(t)?n:o;s.padding[t]=a,C[`padding-${t}`]=`${a}px`};return(t,i)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.component),e.mergeProps(t.$attrs,{ref_key:"wrapperRef",ref:v,class:e.unref(b).b(),style:W.value}),{default:e.withCtx(()=>[e.renderSlot(t.$slots,"default"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(q.value,o=>(e.openBlock(),e.createBlock(e.unref($.TuResizeTrigger),{key:o,class:e.normalizeClass(e.unref(b).e(o)),direction:w(o)?"horizontal":"vertical",onMousedown:n=>{X(o,n)},onResize:n=>{Y(o,n)}},{default:e.withCtx(()=>[t.$slots["resize-trigger"]?e.renderSlot(t.$slots,"resize-trigger",{key:0,direction:o}):e.createCommentVNode("",!0)]),_:2},1032,["class","direction","onMousedown","onResize"]))),128))]),_:3},16,["class","style"]))}});exports.default=U;
